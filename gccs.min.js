#!/usr/bin/env node
(function(t,f){function g(a,l){var c={};a&&"object"===typeof a&&!m(a)&&(c=a,a=c.js_code);if(m(a))return v(a,function(a,b){if(a)return l(a);c.js_code=b;g(c,l)});Buffer.isBuffer(a)&&(a=a.toString(t));var d=a.match(/^#!.{3,}/);c.js_code=a;var b=Object.assign({warning_level:"QUIET",compilation_level:"SIMPLE_OPTIMIZATIONS"},c,{output_info:"compiled_code",output_format:"text"}),p="https"in b&&!b.https?{mod:y,port:80}:{mod:z,port:443},h=p.mod;p=p.port;delete b.https;b=A.stringify(b);h=h.request({hostname:"closure-compiler.appspot.com",
port:p,path:"/compile",method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded","Content-Length":Buffer.byteLength(b)}},function(a){v(a,function(b,c){c&&(c=c.toString(t));d&&(c=d[0]+"\n"+c);l(b,c,a)})});h.on("error",l);h.write(b);h.end();return h}function w(a,b,c){c||"function"!==typeof b||(c=b,b=void 0);a=a!==f?m(a)?a:x.createReadStream(a):process.stdin;if(b){if("string"===typeof b||m(b)){var d=b;b=void 0}else b.out_file&&(d=b.out_file,delete b.out_file);d&&d===f&&(d=process.stdout)}return g(Object.assign({},
b,{js_code:a}),function(a,b){if(a)return c(a);d?(m(d)||(d=x.createWriteStream(d)),d.write(b,t,function(a){c(a,b)}),d._isStdio||d.end()):c(a,b)})}function u(a){var b="Usage:\n    "+q.basename(process.argv[1],".js")+' [ <in_file> [ <out_file> ] ]\n\n    If <out_file> is omitted, out_file = in_file.min.js\n    If <in_file> == "-", stdin is used (<out_file> defaults to "-").\n    If <out_file> == "-", stdout is used.\n    If <in_file> and <out_file> are both omitted, they both default to "-".\n';if(a)a.write(b);
else return b}function v(a,b){var c=[];a.on("data",function(a){c.push(a)});a.on("end",function(){b(null,c=Buffer.concat(c),a)});a.on("error",b);return a}function B(a){if("string"===typeof a)try{return JSON.parse(a)}catch(l){}return a}function m(a){return a&&"object"===typeof a&&"function"===typeof a.pipe}var y=require("http"),z=require("https"),x=require("fs"),q=require("path"),A=require("querystring");g.VERSION="1.3.1";if(module.parent)g.file=w,g.cli_usage=u,module.exports=g;else{for(var k={},r=
process.argv,n=2,b;(b=r[n])&&"--"==b.slice(0,2);){++n;if("--"===b)break;b=b.slice(2);switch(b){case "help":u(process.stdout);process.exit(0);break;default:k[b]=B(r[n++])}}b=r[n]||k.in_file;var e=r[n+1]||k.out_file;b&&b!==f?e||(e=q.join(q.dirname(b),q.basename(b,".js")+".min.js")):(b=f,e||(e=f));k.out_file=e;delete k.in_file;w(b,k,function(a){a&&(console.error(a),u(process.stderr),process.exit(2));e!=f&&console.log("\u001b[32m%s\u001b[0m",e)})}})("utf8","-");
